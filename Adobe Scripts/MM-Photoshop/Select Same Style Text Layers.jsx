if( app.documents.length > 0 ){app.activeDocument.suspendHistory('Select Same Style','selectSameStyle()');}function selectSameStyle(){    if(documents.length > 0){                var doc = activeDocument;        var activeLayer = doc.activeLayer;        var selectedLayers = getSelectedLayersIdx();                    if( activeLayer.kind == LayerKind.TEXT && selectedLayers.length ==1){          var font = activeLayer.textItem.font;          var size = activeLayer.textItem.size;          selectSimilarLayers ();          var allTextLayers = getSelectedLayersIdx();                    var sameStyleLayers = new Array();          for(var i=0; i<allTextLayers.length; i++){             makeActiveByIndex(allTextLayers[i], false);             var textItem = activeDocument.activeLayer.textItem;             if(textItem.font == font && textItem.size==size){                 sameStyleLayers.push(allTextLayers[i]);             }                     }          deselectLayers ();          for(i=0; i<sameStyleLayers.length; i++){            addLayerToSelectionById(sameStyleLayers[i]);          }                  }else{           alert("Select single text layer");        }    }}/////////////////function selectSimilarLayers(){    var idselectSimilarLayers = stringIDToTypeID( "selectSimilarLayers" );    var desc138 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );    var ref76 = new ActionReference();    var idLyr = charIDToTypeID( "Lyr " );    ref76.putName( idLyr, activeDocument.activeLayer.name );    desc138.putReference( idnull, ref76 );    executeAction( idselectSimilarLayers, desc138, DialogModes.NO );}function deselectLayers(){    var idselectNoLayers = stringIDToTypeID( "selectNoLayers" );    var desc85 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );    var ref39 = new ActionReference();    var idLyr = charIDToTypeID( "Lyr " );    var idOrdn = charIDToTypeID( "Ordn" );    var idTrgt = charIDToTypeID( "Trgt" );    ref39.putEnumerated( idLyr, idOrdn, idTrgt );    desc85.putReference( idnull, ref39 );    executeAction( idselectNoLayers, desc85, DialogModes.NO );}//function getNumberOfLayer(){     var ref = new ActionReference();     ref.putEnumerated( charIDToTypeID('Dcmn'), charIDToTypeID('Ordn'), charIDToTypeID('Trgt') );     var desc = executeActionGet(ref);     var numberOfLayer = desc.getInteger(charIDToTypeID('NmbL'));     return numberOfLayer; }function getLayerNameByIndex( idx ) {     var ref = new ActionReference();     ref.putProperty( charIDToTypeID('Prpr') , charIDToTypeID( 'Nm  ' ));     ref.putIndex( charIDToTypeID( 'Lyr ' ), idx );    return executeActionGet(ref).getString(charIDToTypeID( 'Nm  ' ));; }function putLayerNameByIndex( idx, name ) {     if( idx == 0 ) return;    var desc = new ActionDescriptor();        var ref = new ActionReference();        ref.putIndex( charIDToTypeID( 'Lyr ' ), idx );    desc.putReference( charIDToTypeID('null'), ref );        var nameDesc = new ActionDescriptor();        nameDesc.putString( charIDToTypeID('Nm  '), name );    desc.putObject( charIDToTypeID('T   '), charIDToTypeID('Lyr '), nameDesc );    executeAction( charIDToTypeID('setd'), desc, DialogModes.NO );}function getActiveLayerIndex() {     var ref = new ActionReference();     ref.putProperty( 1349677170 , 1232366921 );     ref.putEnumerated( 1283027488, 1332896878, 1416783732 );     var res = executeActionGet(ref).getInteger( 1232366921 )                                                       - Number( hasBackground() );     return res;   }function isValidActiveLayer( idx ) {     var propName = stringIDToTypeID( 'layerSection' );     var ref = new ActionReference();      ref.putProperty( 1349677170 , propName);     ref.putIndex( 1283027488, idx );     var desc =  executeActionGet( ref );     var type = desc.getEnumerationValue( propName );     var res = typeIDToStringID( type );      return res == 'layerSectionEnd' ? false:true;}function hasBackground(){    var res = undefined;    try{        var ref = new ActionReference();        ref.putProperty( 1349677170 , 1315774496);         ref.putIndex( 1283027488, 0 );        executeActionGet(ref).getString(1315774496 );;         res = true;    }catch(e){ res = false}    return res;}function getSelectedLayersIdx(){     var selectedLayers = new Array;     var ref = new ActionReference();     ref.putEnumerated( charIDToTypeID('Dcmn'), charIDToTypeID('Ordn'), charIDToTypeID('Trgt') );     var desc = executeActionGet(ref);     if( desc.hasKey( stringIDToTypeID( 'targetLayers' ) ) ){          desc = desc.getList( stringIDToTypeID( 'targetLayers' ));          var c = desc.count           var selectedLayers = new Array();          for(var i=0;i<c;i++){               selectedLayers.push(  desc.getReference( i ).getIndex());          }     }else{          var ref = new ActionReference();           ref.putProperty( charIDToTypeID('Prpr') , charIDToTypeID( 'ItmI' ));           ref.putEnumerated( charIDToTypeID('Lyr '), charIDToTypeID('Ordn'), charIDToTypeID('Trgt') );          selectedLayers.push( executeActionGet(ref).getInteger(charIDToTypeID( 'ItmI' )));     }     return selectedLayers;}function makeActiveByIndex( idx, visible ){     if( idx.constructor != Array ) idx = [ idx ];     for( var i = 0; i < idx.length; i++ ){          var desc = new ActionDescriptor();          var ref = new ActionReference();          ref.putIndex(charIDToTypeID( 'Lyr ' ), idx[i])          desc.putReference( charIDToTypeID( 'null' ), ref );          if( i > 0 ) {               var idselectionModifier = stringIDToTypeID( 'selectionModifier' );               var idselectionModifierType = stringIDToTypeID( 'selectionModifierType' );               var idaddToSelection = stringIDToTypeID( 'addToSelection' );               desc.putEnumerated( idselectionModifier, idselectionModifierType, idaddToSelection );          }          desc.putBoolean( charIDToTypeID( 'MkVs' ), visible );          executeAction( charIDToTypeID( 'slct' ), desc, DialogModes.NO );     }     }function addLayerToSelectionById(idx){    var idslct = charIDToTypeID( "slct" );    var desc1050 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref533 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        //ref533.putName( idLyr, activeDocument.activeLayer.name );        ref533.putIndex(charIDToTypeID( 'Lyr ' ), idx)    desc1050.putReference( idnull, ref533 );    var idselectionModifier = stringIDToTypeID( "selectionModifier" );    var idselectionModifierType = stringIDToTypeID( "selectionModifierType" );    var idaddToSelection = stringIDToTypeID( "addToSelection" );    desc1050.putEnumerated( idselectionModifier, idselectionModifierType, idaddToSelection );    var idMkVs = charIDToTypeID( "MkVs" );    desc1050.putBoolean( idMkVs, false );executeAction( idslct, desc1050, DialogModes.NO );}