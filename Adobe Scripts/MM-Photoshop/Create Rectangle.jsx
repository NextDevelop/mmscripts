//alert(checkSelection())if( app.documents.length > 0 ){    if(!checkSelection()){        activeDocument.selection.selectAll();    }    app.activeDocument.suspendHistory('Create Rectangle Shape','mainDialog()');}function checkSelection(){	var flg = true;		try{		activeDocument.selection.bounds;	}catch(e){		flg = false;	}		return flg;}function mainDialog() {	var dlg = new Window('dialog', 'Create Rectangle Shape', [100,100,365,500]);		var sBounds = activeDocument.selection.bounds;	dlg.widthLabel 	= dlg.add('statictext', 		[5,50,115,70], 		'Width:');	dlg.widthTxt 		= dlg.add('edittext', 		[5,70,115,90], 		sBounds[2]-sBounds[0]);    	dlg.heightLabel 	= dlg.add('statictext', 		[140,50,255,70], 	'Height:');	dlg.heightTxt 		= dlg.add('edittext', 		[140,70,255,90], 	sBounds[3]-sBounds[1]);    	dlg.roundLabel 	= dlg.add('statictext', 		[5,100,115,120], 	'Round:');	dlg.roundTxt 			= dlg.add('edittext', 		[5,120,115,140], 	0);		dlg.okButton = dlg.add('button', [50,340,150,380], 'OK');	dlg.cancelButton = dlg.add('button', [160,340,260,380], 'Cancel');		dlg.okButton.onClick = function okClick()	{				var doc = activeDocument;        var sx = sBounds[0];        var sy = sBounds[1];        var ex = sBounds[2];        var ey = sBounds[3];        var rnd = dlg.roundTxt.text;        var w = ex-sx;        var h = ey-sy;                if(dlg.widthTxt.text.indexOf(' px')) dlg.widthTxt.text += ' px';        if(dlg.heightTxt.text.indexOf(' px')) dlg.heightTxt.text += ' px';        if(dlg.roundTxt.text.indexOf(' px')) dlg.roundTxt.text += ' px';        if( w != dlg.widthTxt.text){            ex = sx*1 + dlg.widthTxt.text*1;        }        if( h != dlg.heightTxt.text ){            ey = sy*1 + dlg.heightTxt.text*1;        }        drawRoundShape( sx, sy, ex, ey, rnd, app.foregroundColor.rgb, "Rectangle");               		dlg.close();	};		dlg.cancelButton.onClick = function cancelClick() {		dlg.close();	}		dlg.show();}//draw shape    function drawRoundShape(sx, sy, ex, ey, rnd) {                var idMk = charIDToTypeID( "Mk  " );            var desc7 = new ActionDescriptor();            var idnull = charIDToTypeID( "null" );                var ref3 = new ActionReference();                var idcontentLayer = stringIDToTypeID( "contentLayer" );                ref3.putClass( idcontentLayer );            desc7.putReference( idnull, ref3 );            var idUsng = charIDToTypeID( "Usng" );                var desc8 = new ActionDescriptor();                var idType = charIDToTypeID( "Type" );                var idsolidColorLayer = stringIDToTypeID( "solidColorLayer" );                desc8.putClass( idType, idsolidColorLayer );                var idShp = charIDToTypeID( "Shp " );                    var desc9 = new ActionDescriptor();                    var idTop = charIDToTypeID( "Top " );                    var idPxl = charIDToTypeID( "#Pxl" );                    desc9.putUnitDouble( idTop, idPxl, sy );                    var idLeft = charIDToTypeID( "Left" );                    var idPxl = charIDToTypeID( "#Pxl" );                    desc9.putUnitDouble( idLeft, idPxl, sx );                    var idBtom = charIDToTypeID( "Btom" );                    var idPxl = charIDToTypeID( "#Pxl" );                    desc9.putUnitDouble( idBtom, idPxl, ey);                    var idRght = charIDToTypeID( "Rght" );                    var idPxl = charIDToTypeID( "#Pxl" );                    desc9.putUnitDouble( idRght, idPxl, ex );                    var idRds = charIDToTypeID( "Rds " );                    var idPxl = charIDToTypeID( "#Pxl" );                    desc9.putUnitDouble( idRds, idPxl, rnd );                var idRctn = charIDToTypeID( "Rctn" );                desc8.putObject( idShp, idRctn, desc9 );            var idcontentLayer = stringIDToTypeID( "contentLayer" );            desc7.putObject( idUsng, idcontentLayer, desc8 );        executeAction( idMk, desc7, DialogModes.NO );    }    // draw shape    function drawShape(sx, sy, ex, ey, color, name) {        //var rgb = toRGB(color);        var rgb = { r: color.red, g: color.green, b: color.blue };        var id1 = charIDToTypeID('Mk  ');        var desc1 = new ActionDescriptor();        var id2 = charIDToTypeID('null');        var ref1 = new ActionReference();        var id3 = stringIDToTypeID('contentLayer');        ref1.putClass(id3);        desc1.putReference(id2, ref1);        var id4 = charIDToTypeID('Usng');        var desc2 = new ActionDescriptor();        var id5 = charIDToTypeID('Type');        var id6 = stringIDToTypeID('solidColorLayer');        desc2.putClass(id5, id6);        var id7 = charIDToTypeID('Shp ');        var desc3 = new ActionDescriptor();        var id8 = charIDToTypeID('Top ');        var id9 = charIDToTypeID('#Pxl');        desc3.putUnitDouble(id8, id9, sy);        var id10 = charIDToTypeID('Left');        var id11 = charIDToTypeID('#Pxl');        desc3.putUnitDouble(id10, id11, sx);        var id12 = charIDToTypeID('Btom');        var id13 = charIDToTypeID('#Pxl');        desc3.putUnitDouble(id12, id13, ey);        var id14 = charIDToTypeID('Rght');        var id15 = charIDToTypeID('#Pxl');        desc3.putUnitDouble(id14, id15, ex);        var id16 = charIDToTypeID('Rctn');        desc2.putObject(id7, id16, desc3);        var id17 = stringIDToTypeID('contentLayer');        desc1.putObject(id4, id17, desc2);        executeAction(id1, desc1, DialogModes.NO);        var id18 = charIDToTypeID('setd');        var desc4 = new ActionDescriptor();        var id19 = charIDToTypeID('null');        var ref2 = new ActionReference();        var id20 = stringIDToTypeID('contentLayer');        var id21 = charIDToTypeID('Ordn');        var id22 = charIDToTypeID('Trgt');        ref2.putEnumerated(id20, id21, id22);        desc4.putReference(id19, ref2);        var id23 = charIDToTypeID('T   ');        var desc5 = new ActionDescriptor();        var id24 = charIDToTypeID('Clr ');        var desc6 = new ActionDescriptor();        var id25 = charIDToTypeID('Rd  ');        desc6.putDouble(id25, rgb.r);        var id26 = charIDToTypeID('Grn ');        desc6.putDouble(id26, rgb.g);        var id27 = charIDToTypeID('Bl  ');        desc6.putDouble(id27, rgb.b);        var id28 = charIDToTypeID('RGBC');        desc5.putObject(id24, id28, desc6);        var id29 = stringIDToTypeID('solidColorLayer');        desc4.putObject(id23, id29, desc5);        executeAction(id18, desc4, DialogModes.NO);        var id30 = charIDToTypeID('setd');        var desc7 = new ActionDescriptor();        var id31 = charIDToTypeID('null');        var ref3 = new ActionReference();        var id32 = charIDToTypeID('Lyr ');        var id33 = charIDToTypeID('Ordn');        var id34 = charIDToTypeID('Trgt');        ref3.putEnumerated(id32, id33, id34);        desc7.putReference(id31, ref3);        var id35 = charIDToTypeID('T   ');        var desc8 = new ActionDescriptor();        var id36 = charIDToTypeID('Nm  ');        desc8.putString(id36, name);        var id37 = charIDToTypeID('Lyr ');        desc7.putObject(id35, id37, desc8);        executeAction(id30, desc7, DialogModes.NO);    }    function toRGB(code) {        var dec = parseInt('0x' + code);        var r = (dec & 0xff0000) >>> 0x000010;        var g = (dec & 0x00ff00) >>> 0x000008;        var b = (dec & 0x0000ff);        return { r: r, g: g, b: b };    }